<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>刷題練習網站</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        h1 {
            text-align: center;
        }
        .question {
            margin-bottom: 20px;
        }
        .answer {
            margin-top: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-left: 4px solid #007BFF;
            visibility: hidden;
        }
        details[open] .answer {
            visibility: visible;
        }
    </style>
</head>
<body>
    <h1>刷題練習網站</h1>

    <div id="questions"></div>

    <script>
        function generateRandomNumber(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateQuestions() {
            const questionsContainer = document.getElementById('questions');

            // 清空之前的題目
            questionsContainer.innerHTML = '';

            // 題目1：卜瓦松分佈
            const lambda1 = generateRandomNumber(3, 10);
            const k1 = generateRandomNumber(1, 10);
            const poissonQuestion = document.createElement('div');
            poissonQuestion.className = 'question';
            poissonQuestion.innerHTML = `
                <h2>題目1</h2>
                <p>某餐廳平均每小時接到${lambda1}個訂單。求該餐廳在某一小時內接到${k1}個訂單的概率。</p>
                <details>
                    <summary>顯示答案</summary>
                    <div class="answer" id="answer1"></div>
                </details>
            `;
            questionsContainer.appendChild(poissonQuestion);

            // 題目2：常態分佈
            const mean2 = generateRandomNumber(20, 30);
            const stddev2 = generateRandomNumber(2, 10);
            const value2 = mean2 - generateRandomNumber(1, 5);
            const normalQuestion1 = document.createElement('div');
            normalQuestion1.className = 'question';
            normalQuestion1.innerHTML = `
                <h2>題目2</h2>
                <p>某城市的日平均氣溫呈常態分佈，平均氣溫為${mean2}°C，標準差為${stddev2}°C。某天的日平均氣溫是${value2}°C，計算該天的Z值，並查標準常態分佈表得知其累積機率。求日平均氣溫低於${value2}°C的天數比例。</p>
                <details>
                    <summary>顯示答案</summary>
                    <div class="answer" id="answer2"></div>
                </details>
            `;
            questionsContainer.appendChild(normalQuestion1);

            // 題目3：常態分佈
            const mean3 = generateRandomNumber(40, 60);
            const stddev3 = generateRandomNumber(5, 10);
            const value3 = mean3 - generateRandomNumber(1, 5);
            const normalQuestion2 = document.createElement('div');
            normalQuestion2.className = 'question';
            normalQuestion2.innerHTML = `
                <h2>題目3</h2>
                <p>某工廠生產的零件重量呈常態分佈，平均重量為${mean3}克，標準差為${stddev3}克。某個零件的重量是${value3}克，計算該零件的Z值，並查標準常態分佈表得知其累積機率。求重量低於${value3}克的零件比例。</p>
                <details>
                    <summary>顯示答案</summary>
                    <div class="answer" id="answer3"></div>
                </details>
            `;
            questionsContainer.appendChild(normalQuestion2);

            // 題目4：二項分佈
            const p4 = generateRandomNumber(50, 90) / 100;
            const n4 = generateRandomNumber(20, 50);
            const binomialQuestion = document.createElement('div');
            binomialQuestion.className = 'question';
            binomialQuestion.innerHTML = `
                <h2>題目4</h2>
                <p>某種子粒的發芽率為${(p4 * 100).toFixed(0)}%。某農民種下${n4}顆子粒，求發芽子粒的期望值和變異數。</p>
                <details>
                    <summary>顯示答案</summary>
                    <div class="answer" id="answer4"></div>
                </details>
            `;
            questionsContainer.appendChild(binomialQuestion);

            // 題目5：指數分佈
            const lambda5 = generateRandomNumber(1, 5);
            const time5 = generateRandomNumber(1, 10);
            const exponentialQuestion = document.createElement('div');
            exponentialQuestion.className = 'question';
            exponentialQuestion.innerHTML = `
                <h2>題目5</h2>
                <p>某電子產品的故障時間 X 服從指數分佈，平均每年發生${lambda5}次故障。計算該產品在${time5}年內不會發生故障的概率。</p>
                <details>
                    <summary>顯示答案</summary>
                    <div class="answer" id="answer5"></div>
                </details>
            `;
            questionsContainer.appendChild(exponentialQuestion);

            // 題目6：期望值和變異數計算
            const values = [50, 60, 70, 80];
            const probabilities = [0.1, 0.2, 0.3, 0.4];
            const expectationQuestion = document.createElement('div');
            expectationQuestion.className = 'question';
            expectationQuestion.innerHTML = `
                <h2>題目6</h2>
                <p>某隨機變量 X 取值如下，其中每個取值的概率如下表所示。計算期望值 E(X) 和變異數 Var(X)。</p>
                <p>取值 X: ${values.join(', ')}</p>
                <p>概率 P(X): ${probabilities.join(', ')}</p>
                <details>
                    <summary>顯示答案</summary>
                    <div class="answer" id="answer6"></div>
                </details>
            `;
            questionsContainer.appendChild(expectationQuestion);

            // 題目7：二項次分佈
            const n7 = generateRandomNumber(10, 20);
            const p7 = generateRandomNumber(1, 9) / 10;
            const k7 = generateRandomNumber(0, n7);
            const binomialExpansionQuestion = document.createElement('div');
            binomialExpansionQuestion.className = 'question';
            binomialExpansionQuestion.innerHTML = `
                <h2>題目7</h2>
                <p>某件商品的合格率為${(p7 * 100).toFixed(0)}%。某廠商從中隨機抽取${n7}件商品，求其中恰有${k7}件商品合格的概率。</p>
                <details>
                    <summary>顯示答案</summary>
                    <div class="answer" id="answer7"></div>
                </details>
            `;
            questionsContainer.appendChild(binomialExpansionQuestion);

            // 計算答案
            document.getElementById('answer1').innerHTML = generatePoissonExplanation(lambda1, k1);
            document.getElementById('answer2').innerHTML = generateNormalExplanation(mean2, stddev2, value2);
            document.getElementById('answer3').innerHTML = generateNormalExplanation(mean3, stddev3, value3);
            document.getElementById('answer4').innerHTML = generateBinomialExplanation(n4, p4);
            document.getElementById('answer5').innerHTML = generateExponentialExplanation(lambda5, time5);
            document.getElementById('answer6').innerHTML = generateExpectationAndVarianceExplanation(values, probabilities);
            document.getElementById('answer7').innerHTML = generateBinomialExpansionExplanation(n7, p7, k7);
        }

        function generatePoissonExplanation(lambda, k) {
            const factorial = (n) => (n === 0 ? 1 : n * factorial(n - 1));
            const probability = (Math.pow(lambda, k) * Math.exp(-lambda)) / factorial(k);
            return `
                <p>使用卜瓦松分佈的公式計算：</p>
                <p>P(X = k) = &lambda;<sup>k</sup> e<sup>-&lambda;</sup> / k!</p>
                <p>其中，&lambda; = ${lambda} ，k = ${k}</p>
                <p>計算步驟：</p>
                <p>P(X = ${k}) = ${lambda}<sup>${k}</sup> &times; e<sup>- ${lambda}</sup> / ${k}! = ${Math.pow(lambda, k).toFixed(4)} &times; ${Math.exp(-lambda).toFixed(4)} / ${factorial(k)} &approx; ${probability.toFixed(4)}</p>
            `;
        }

        function generateNormalExplanation(mean, stddev, value) {
            const variance = Math.pow(stddev, 2);
            const exponent = -Math.pow(value - mean, 2) / (2 * variance);
            const probabilityDensity = (1 / (stddev * Math.sqrt(2 * Math.PI))) * Math.exp(exponent);
            return `
                <p>計算概率密度函數：</p>
                <p>f(x) = 1 / (σ√(2π)) * e^(-(x - μ)^2 / (2σ^2))</p>
                <p>其中，μ = ${mean} ，σ = ${stddev}</p>
                <p>計算步驟：</p>
                <p>f(${value}) = 1 / (${stddev} * √(2π)) * e^(-(${value} - ${mean})^2 / (2 * ${variance}))</p>
                <p>f(${value}) = 1 / (${stddev} * √(2π)) * e^(${exponent.toFixed(4)})</p>
                <p>f(${value}) ≈ ${probabilityDensity.toFixed(4)}</p>
            `;
        }

        function erf(x) {
            // Abramowitz and Stegun approximation
            const sign = x >= 0 ? 1 : -1;
            x = Math.abs(x);
            const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741, a4 = -1.453152027, a5 = 1.061405429;
            const p = 0.3275911;
            const t = 1.0 / (1.0 + p * x);
            const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
            return sign * y;
        }

        function generateBinomialExplanation(n, p) {
            const mean = n * p;
            const variance = n * p * (1 - p);
            return `
                <p>使用二項分佈的期望值和變異數公式計算：</p>
                <p>期望值 E(X) = np</p>
                <p>變異數 Var(X) = np(1 - p)</p>
                <p>其中，n = ${n} ，p = ${p.toFixed(2)}</p>
                <p>計算步驟：</p>
                <p>期望值 E(X) = ${n} &times; ${p.toFixed(2)} = ${mean.toFixed(2)}</p>
                <p>變異數 Var(X) = ${n} &times; ${p.toFixed(2)} &times; (1 - ${p.toFixed(2)}) = ${variance.toFixed(2)}</p>
            `;
        }

        function generateExponentialExplanation(lambda, time) {
            const probability = Math.exp(-lambda * time);
            return `
                <p>使用指數分佈的公式計算：</p>
                <p>P(X > x) = e<sup>-&lambda; x</sup></p>
                <p>其中，&lambda; = ${lambda} ，x = ${time}</p>
                <p>計算步驟：</p>
                <p>P(X > ${time}) = e<sup>- ${lambda} &times; ${time}</sup> = e<sup>- ${lambda * time}</sup> &approx; ${probability.toFixed(4)}</p>
            `;
        }

        function generateExpectationAndVarianceExplanation(values, probabilities) {
            const mean = values.reduce((sum, x, i) => sum + x * probabilities[i], 0);
            const variance = values.reduce((sum, x, i) => sum + Math.pow(x - mean, 2) * probabilities[i], 0);
            return `
                <p>計算期望值和變異數：</p>
                <p>期望值 E(X) = &sum; x<sub>i</sub> P(x<sub>i</sub>)</p>
                <p>變異數 Var(X) = &sum; (x<sub>i</sub> - E(X))<sup>2</sup> P(x<sub>i</sub>)</p>
                <p>計算步驟：</p>
                <p>期望值 E(X) = ${values.map((x, i) => `${x} &times; ${probabilities[i]}`).join(' + ')} = ${mean.toFixed(2)}</p>
                <p>變異數 Var(X) = ${values.map((x, i) => `(${x} - ${mean.toFixed(2)})<sup>2</sup> &times; ${probabilities[i]}`).join(' + ')} = ${variance.toFixed(2)}</p>
            `;
        }
        function generateBinomialExpansionExplanation(n, p, k) {
            const factorial = (n) => (n === 0 ? 1 : n * factorial(n - 1));
            const combination = factorial(n) / (factorial(k) * factorial(n - k));
            const probability = combination * Math.pow(p, k) * Math.pow(1 - p, n - k);
            return `
                <p>使用二項次分佈的公式計算：</p>
                <p>P(X = k) = C(n, k) p<sup>k</sup> (1-p)<sup>n-k</sup></p>
                <p>其中，n = ${n} ，p = ${p.toFixed(2)} ，k = ${k}</p>
                <p>計算步驟：</p>
                <p>C(n, k) = ${n}! / (${k}! (${n} - ${k})!) = ${combination.toFixed(0)}</p>
                <p>P(X = ${k}) = ${combination.toFixed(0)} &times; ${p.toFixed(2)}<sup>${k}</sup> &times; (1 - ${p.toFixed(2)})<sup>${n - k}</sup> &approx; ${probability.toFixed(4)}</p>
            `;
        }

        document.addEventListener('DOMContentLoaded', function() {
            generateQuestions();
        });
    </script>
</body>
</html>
